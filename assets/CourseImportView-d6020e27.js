import{e as N,X as k,Y as x,k as h,J as I,o as S,c as U,a as r,w as e,d as o,S as t,a0 as u,a4 as D,b as L,N as _,a5 as V,F as A}from"./index-ecfabf3d.js";import{N as H,a as f}from"./DescriptionsItem-479ae5d1.js";import{u as q}from"./use-message-138c1ad0.js";import{a as E}from"./headers-21fe1a02.js";import{N as B}from"./Spin-c305590a.js";import{_ as z}from"./_plugin-vue_export-helper-c27b6911.js";import"./use-compitable-95cdef1d.js";import"./get-slot-1efb97e5.js";const F={class:"d-flex justify-content-end"},M=N({__name:"CourseImportView",props:{name:{type:String,required:!0},author:{type:String,required:!0},version:{type:String,required:!0},courseLocation:{type:String,required:!0},groupHash:{type:String,required:!0}},setup(n){const a=n,m=k(),p=q(),g=x(),i=h(!0),l=h(!1),c=h(!1);I(async()=>{y(a.courseLocation,a.groupHash)});async function y(s,v){if(!s||!v||!a.name||!a.author||!a.version){p.error("Unsupported content type"),i.value=!1,c.value=!0;return}c.value=!1;try{i.value=!0;const d=await g.checkCourseExists(a.courseLocation,a.groupHash);d&&m.push({name:"courseDetail",params:{courseUUID:d}})}catch(d){p.error(d instanceof Error?d.message:"Unknown error")}finally{i.value=!1}}function C(){return{"dim-on-loading":i.value||l.value||c.value}}function b(){m.push({name:"courseList"})}async function w(){try{l.value=!0;const s=await g.addCourse(a.name,a.author,parseInt(a.version),a.groupHash,a.courseLocation);m.push({name:"courseDetail",params:{courseUUID:s}})}catch(s){p.error(s instanceof Error?s.message:"Unknown error")}finally{l.value=!1}}return(s,v)=>(S(),U(A,null,[r(t(E),null,{default:e(()=>[o("Add a new course...")]),_:1}),r(t(B),{show:i.value||l.value},{description:e(()=>[o(u(l.value?"Uploading the course...":"Checking if course is available..."),1)]),default:e(()=>[r(t(D),{style:{"max-width":"50rem","margin-left":"auto","margin-right":"auto","margin-top":"5%"}},{footer:e(()=>[L("div",F,[r(t(_),{onClick:b,style:{"margin-right":"0.5rem"},ghost:"",disabled:c.value},{default:e(()=>[o("Cancel")]),_:1},8,["disabled"]),r(t(_),{onClick:w,type:"primary",disabled:c.value},{default:e(()=>[o("Add")]),_:1},8,["disabled"])])]),default:e(()=>[r(t(H),{class:V(C),title:"Details","label-placement":"left",bordered:"",size:"small"},{default:e(()=>[r(t(f),{label:"Name:"},{default:e(()=>[o(u(n.name),1)]),_:1}),r(t(f),{label:"Author:"},{default:e(()=>[o(u(n.author),1)]),_:1}),r(t(f),{label:"Version:"},{default:e(()=>[o(u(n.version),1)]),_:1}),r(t(f),{label:"Course location:"},{default:e(()=>[o(u(n.courseLocation),1)]),_:1}),r(t(f),{label:"Course URL:"},{default:e(()=>[o(u(n.groupHash),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["show"])],64))}});const K=z(M,[["__scopeId","data-v-84579fb8"]]);export{K as default};
