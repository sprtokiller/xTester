import{e as g,o as _,c as T,b as k,a6 as x,Y as N,k as v,X as U,a2 as I,R as b,S as f,h as i,N as y,a as u,w as C,d as S,F as P}from"./index-ecfabf3d.js";import{N as V,R as B,A as L,T as z}from"./TestNoUsersWarning-fb91b819.js";import{u as E}from"./use-message-138c1ad0.js";import{N as F}from"./Suffix-68b02f76.js";import{N as M}from"./headers-21fe1a02.js";import"./Icon-07367168.js";import"./AddRound-565d42ee.js";import"./Popover-34c164ec.js";import"./use-compitable-95cdef1d.js";import"./Input-bf9f1185.js";import"./testerStore-a2a3d84b.js";import"./create-aae2c7cf.js";import"./Forward-dcfc1aab.js";import"./create-ref-setter-f485918b.js";import"./RadioGroup-7f8274e5.js";import"./get-slot-1efb97e5.js";import"./Dropdown-1b62357b.js";import"./ChevronRight-0b4f2ec1.js";import"./use-keyboard-4a570dec.js";import"./_plugin-vue_export-helper-c27b6911.js";const R={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},W=k("path",{d:"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2s2 .9 2 2s-.9 2-2 2zm3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1c1.71 0 3.1 1.39 3.1 3.1v2z",fill:"currentColor"},null,-1),H=[W],q=g({name:"LockFilled",render:function(t,s){return _(),T("svg",R,H)}}),G=x("testStore",()=>{const l=N(),t=v([]);async function s(c){t.value=t.value.map(r=>(r.testUUID===c&&(r.endType="WIP"),r)),await l.lockTest(c),t.value=t.value.map(r=>(r.testUUID===c&&(r.endAt=new Date,r.endType="MANUAL"),r))}async function d(){t.value=await l.getTestList()}return{tests:t,lockTest:s,fetchTests:d}}),$=g({__name:"TestTable",setup(l){function t(e){return i("span",{style:"color: var(--gray-2)"},{default:()=>e})}function s(e,n,a="medium"){return i(F,{bordered:!1,type:e,size:a,style:"margin-right: 6px"},{default:()=>n})}const d=e=>{const n=new Date,a=e.startAt?new Date(e.startAt):null,o=e.endAt?new Date(e.endAt):null;return a?a>n?s("warning","Planned"):!o||o>n?s("info","Active"):s("success","Completed"):null},c=[{title:"Test name",key:"name",ellipsis:!0},{title:"State",key:"state",width:160,render(e){return d(e)}},{title:"Course",key:"courseView",align:"center",width:80,render(e){return i(y,{circle:!0,quaternary:!0,size:"small",class:"btn-less-visible",renderIcon:()=>i(B),onClick:n=>{n.stopPropagation(),r.push({name:"courseDetail",params:{courseUUID:e.courseUUID}})}})}},{title:"End",key:"endAt",width:200,align:"center",render(e){const n=new Date,a=e.startAt?new Date(e.startAt):null,o=e.endAt?new Date(e.endAt):null;return a?a>n?t("Not started yet "):o?o>n?t(o.toLocaleString()):null:i(y,{loading:e.endType==="WIP",disabled:e.endType==="WIP",quaternary:!0,size:"small",class:"btn-less-visible",renderIcon:()=>i(q),onClick:async D=>{D.stopPropagation();try{await m.lockTest(e.testUUID)}catch(h){w.error(h instanceof Error?h.message:"Unknown error")}}},{default:()=>"Click to end"}):null}}],r=U(),w=E(),m=G(),p=v(!0),A=e=>({style:"cursor: pointer",onClick:()=>{r.push({name:"testingDetail",params:{testUUID:e.testUUID}})}});return I(async()=>{try{p.value=!0,await m.fetchTests()}catch(e){w.error(e instanceof Error?e.message:"Unknown error")}finally{p.value=!1}}),(e,n)=>(_(),b(f(V),{columns:c,data:f(m).tests,bordered:!1,loading:p.value,"row-props":A},null,8,["data","loading"]))}}),X={class:"d-flex"},pe=g({__name:"TestsView",setup(l){return(t,s)=>(_(),T(P,null,[k("div",X,[u(f(M),null,{default:C(()=>[S("List of tests")]),_:1}),u(L)]),u(z),u($)],64))}});export{pe as default};
